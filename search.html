<!DOCTYPE html>
<html lang="en" data-loc="root">
  <head>
    <meta charset="UTF-8">
    <title>Search XYR.codes üîç</title>
    <meta name="author" content="Xyrus Kurt Roldan">
    <meta name="description" content="Search within pages with the all-new special in-house-developed bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm¬Æ‚Ñ¢, only available in this page.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Search">
    <meta property="og:description" content="Search within pages with the all-new special in-house-developed bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm 99¬Æ‚Ñ¢, only available in this page.">
    <meta property="og:image" content="http://xyr.codes/i/emb.png">
    <meta property="og:url" content="https://xyr.codes/search.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="theme-color" content="#77e4ff">
    <link href="favicon.ico" rel="shortcut icon" type="image/ico">
    <link href="main.css" rel="stylesheet">
    <style>
      .search {margin: .5em 0 .8em 0}

      .searchbar {
        display: flex;
        position: relative;
        overflow: hidden;
      }
      #text {
        padding: .4em 1.8em .4em .4em;
        font-size: inherit;
        background-color: var(--article-bg);
        color: var(--text);
        border: 1px solid transparent;
        border-radius: 8px;
        max-width: 100%;
        outline: none;
        flex-grow: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      #text:focus {border-color: var(--link-active)}
      #searchBtn {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        right: .2em;
        font-size: inherit;
        height: 100%;
        cursor: pointer;
        background: transparent;
        border: 1px solid transparent;
        outline: 0;
        transition: color .3s;
        color: var(--text);
      }
      #searchBtn::before {
        font-family: 'simple-line-icons';
        content: '\e090';
        position: relative;
        top: -.05em;
        padding-left: .2em;
        background-color: var(--article-bg);
      }
      #searchBtn:hover, #searchBtn:focus {color: var(--link-active)}
      #searchBtn:focus-visible {border: 1px solid}
      @media (min-width: 450px) and (hover: hover) {
        .focus #text {padding-right: 5.5em}
        #searchBtn {
          animation: fancyReverse .6s;
        }
        #searchBtn::after {
          visibility: hidden;
          opacity: 0;
          content: '';
          padding-left: .3em;
          background-color: var(--article-bg);
          animation: fadeReverse .6s;
        }
        .focus #searchBtn, #searchBtn:hover {
          right: .3em;
          animation: fancy .6s;
        }
        .focus #searchBtn::after, #searchBtn:hover::after {
          visibility: visible;
          opacity: 1;
          content: 'Search';
          animation: fade .6s;
        }
      }

      #advanced {margin-top: .4em}
      .fieldsets {
        display: flex;
        flex-wrap: wrap;
      }
      fieldset {
        width: calc(50% - 1em);
        min-width: 120px;
        flex-grow: 1;
        margin: 0 .5em .5em .5em;
        border: 1px solid var(--link-active);
      }

      @keyframes fancy {
        0% {right: -2.8em}
        100% {right: .3em}
      }
      @keyframes fancyReverse {
        0% {right: .3em}
        30% {right: .3em}
        30.0001% {right: 3.1em}
        100% {right: .3em}
      }
      @keyframes fade {
        0% {visibility: hidden; opacity: 0}
        45% {visibility: hidden; opacity: 0}
        100% {visibility: visible; opacity: 1}
      }
      @keyframes fadeReverse {
        0% {visibility: visible; opacity: 1; content: 'Search'}
        55% {visibility: hidden; opacity: 0}
        100% {visibility: hidden; opacity: 0}
      }
    </style>
  </head>
  <body>
    <header role="banner">
      <div id="bg" style="background-color:#0B161D" aria-hidden="true"></div>
      <h1 aria-labelledby="pagetitle"><a id="pagetitle" href="index.html">XYR<span style="color:#77e4ff">.</span>codes</a></h1>
      <p aria-label="Subtitle">Projects, tutorials, photography, blogs, and more!</p>
    </header>
    <nav role="navigation">
      <a href="index.html">Home</a>
      <a href="search.html?t=Programming" aria-label="Browse pages under Programming">Programming</a>
      <a href="search.html?t=Journals" aria-label="Browse pages under Journals">Journals</a>
      <a href="search.html?t=Photography" aria-label="Browse pages under Photography">Photography</a>
      <a href="site/about.html">About</a>
      <a id="search" class="icon" href="search.html" aria-label="Search XYR.codes">Search</a>
    </nav>
    <div class="main">
      <main role="main" aria-labelledby="title">
        <h1 id="title" class="posts hide-stype">Search</h1>
        <div id="msg"></div>
        <div class="search">
          <div class="searchbar">
            <input type="text" id="text" placeholder="Search stuff..." aria-label="Search XYR.codes" autocomplete="off"> <button id="searchBtn" aria-label="Click to search" tabindex="0"></button>
          </div>
          <h1 id="typeHeader" class="hide-stext" style="display: block; margin: .6em 0 0"></h1>
          <details id="advanced">
            <summary>Advanced options</summary>
            <div class="fieldsets">
              <fieldset id="includes" class="hide-stype">
                <legend>Search includes:</legend>
                <div> <input type="checkbox" id="name"> <label for="name" title="article/page title">Page title</label> </div>
                <div> <input type="checkbox" id="desc"> <label for="desc" title="meta description">Page description</label> </div>
                <div> <input type="checkbox" id="content"> <label for="content">Page content</label> </div>
                <div> <input type="checkbox" id="alt"> <label for="alt" title="alt text of images">Image descriptions</label> </div>
              </fieldset>
              <fieldset id="sort">
                <legend>Sort results by:</legend>
                <div class="hide-stype"> <input type="radio" id="relevance" name="sort" checked="true"> <label for="relevance" title="Sorted with the highest 'word and potential word' count">Relevance</label> </div>
                <div class="hide-stype"> <input type="radio" id="relevanceplus" name="sort"> <label for="relevanceplus" title="'Word and potential word' count but taking into account the total number of words">Relevance+</label> </div>
                <div> <input type="radio" id="date-new" name="sort"> <label for="date-new">Date (newest)</label> </div>
                <div> <input type="radio" id="date-old" name="sort"> <label for="date-old">Date (oldest)</label> </div>
                <div> <input type="radio" id="a-z" name="sort"> <label for="a-z">A-Z (Title)</label> </div>
              </fieldset>
            </div>
          </details>
        </div>
        <div id="output" class="horiz" aria-label="Search results"></div>
      </main>
      <aside></aside>
    </div>
    <footer role="contentinfo" aria-label="Footer">
      <h1 class="name">XYR.codes</h1>
      <p>Powered by the special in-house-developed very powerful bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm 99¬Æ‚Ñ¢, only available in this page.</p>
      <div class="ico" aria-hidden="true">
        <img src="i/fav.ico" alt="">
      </div>
      <div class="links" aria-label="Footer links">
        <div class="col">
          <a href="index.html">Home</a>
          <a href="site/about.html">About</a>
          <a href="contact/index.html">Contact</a>
          <a href="contact/feedback.html">Feedback</a>
        </div>
        <div class="col">
          <a href="search.html">Search</a>
          <a href="versions/index.html">Versions</a>
          <a href="site/credits.html">Credits</a>
          <a href="site/sitemap.html">Sitemap</a>
        </div>
        <div class="col">
          <span class="social">
            <a class="gthb" href="https://github.com/xyr11/xyr11.github.io" title="Check the repository on GitHub"></a> <a class="twtr" href="https://twitter.com/xy_rus/" title="Follow me on Twitter"></a> <a class="doc" href="https://github.com/xyr11/xyr11.github.io/blob/main/README.md" title="Read the README.md file"></a>
          </span>
          <a href="site/license.html">License</a>
          <a id="gototop" tabindex="0">Go to top</a>
        </div>
      </div>
    </footer>
    <script src="files/search.js"></script>
    <script type="text/javascript" src="files/main.js"></script>
    <!-- Magic happens here -->
    <script>
      /* global Search, id, changeDates, newNotif */

      // Search
      // search bar
      const searchBar = document.querySelector('.searchbar').classList
      const searchBtn = id('searchBtn')
      const text = id('text')

      // page design
      text.addEventListener('focus', () => searchBar.add('focus'))
      text.addEventListener('blur', () => searchBar.remove('focus'))

      // advanced options
      // properties
      const includeVals = ['name', 'desc', 'content', 'alt']
      // sort
      const sortVals = ['relevance', 'relevanceplus', 'date-new', 'date-old', 'a-z']

      // remove values from back-forward cache (BFCache) when user is using the 'Click to go back' thing
      for (const i of includeVals) id(i).autocomplete = 'off'
      for (const i of sortVals) id(i).autocomplete = 'off'

      // check search params
      function getParam (param = new URLSearchParams(new URL(document.URL).search)) {
        // check text and type
        // only one can be searched separately, text will take precendence if both exists
        const text = param.get('q') || param.get('query') || param.get('text')
        const type = param.get('t') || param.get('type')
        if (!text && !type) return { type: null } // return null if aren't any values

        // get property
        let prop = param.get('p') || param.get('property') || 'name,desc,content,alt'
        // filter property
        if (prop) {
          prop = prop.split(',')
          for (const i of prop) {
            if (includeVals.indexOf(i) <= -1) prop.splice(prop.indexOf(i), 1) // if not a valid value, remove that value
            else if (text) id(i).checked = true // else set the checkbox to true
          }
        }

        // get sort
        let sort = param.get('s') || param.get('sort') || 'relevance'
        if (sortVals.indexOf(sort) <= -1) sort = 'relevance'
        if (!text) if (['relevance', 'relevanceplus'].indexOf(sort) > -1) sort = 'date-new'
        id(sort).checked = true // display

        return {
          type: text ? 'text' : type ? 'type' : null,
          t: text ? 1 : type ? 0 : null,
          search: (text ?? type).replace(/^\s|\s{2}|\s$/g, ''),
          prop: text ? prop.join(' ') : null, // property only exists in text search and not type search
          sort
        }
      }

      const param = getParam()
      let rawOutput
      if (param.t === 1 || param.t === 0) {
        document.title = `param.search ${param.t ? '- Search' : '|'} XYR.codes` // change title

        // hide stuff
        for (const i of document.getElementsByClassName(`hide-s${param.type}`)) i.style.display = 'none'

        // change stuff
        if (param.t) id('text').value = param.search
        else {
          id('typeHeader').innerHTML = `Type: ${param.search}`
          // add event listener
          id('sort').addEventListener('input', e => { if (param.sort !== e.target.id) window.location.href = `search.html?t=${param.search}&s=${e.target.id}` })
        }

        if (param.prop !== 'name desc content alt' || (param.t && param.sort !== 'relevance') || (!param.t && param.sort !== 'date-new')
        ) id('advanced').open = 'true' // if params arent the default values, open advanced options

        rawOutput = param.t ? Search.text(param.search, param.prop, param.sort) : Search.type(param.search, param.sort)
      } else {
        // if no params are given
        text.focus()
        for (const i of includeVals) id(i).checked = 'true'
        id('typeHeader').style.display = 'none'
        id('msg').innerHTML = 'Search for stuff within XYR.codes by entering it in the search bar below and we\'ll give back pages with that stuff. Word order is not checked.'
      }

      // create params
      function createParams () {
        if (!id('text').value) return null

        // get advanced options
        let property = []
        for (const i of includeVals) if (id(i).checked) property.push(i) // get checked properties
        property = property.join(',')
        if (param.t && !property) { // nothing is checked
          newNotif('The "Search includes" part must have <b>at least one</b> checked option.')
          return null
        }

        // sort
        let sort = ''
        for (const i of sortVals) if (id(i).checked && i !== 'relevance') sort = i // get checked value if its not the default value
        if (param.t === 0) sort = '' // for type search

        return `search.html?q=${id('text').value}` +
          (property !== 'name,desc,content,alt' ? `&p=${property}` : '') +
          (sort && `&s=${sort}`)
      }

      // if clicked searchBtn
      searchBtn.addEventListener('click', () => { if (createParams()) window.location.href = createParams() })
      // if pressed enter
      text.addEventListener('keydown', e => (e.key === 'Enter') && searchBtn.click())
      searchBtn.addEventListener('keydown', e => (e.key === 'Enter') && searchBtn.click())

      // display results
      const output = id('output')
      if (rawOutput) {
        if (!rawOutput.length) output.innerHTML = 'Unfortunately, we didn\'t find any results. Please try again.'
        for (const i of rawOutput) {
          // create element
          const result = document.createElement('a')
          result.setAttribute('href', i.location)
          result.setAttribute('class', 'post result')
          result.innerHTML = `<h2>${i.name}</h2>${i.date ? `<p class="time" data-posted="${new Date(i.date).toISOString().slice(0, 10)}">${new Date(i.date).toLocaleString('default', { dateStyle: 'long' })}</p>` : ''}<p>${i.desc}</p>`
          output.appendChild(result)
        }
      }
      changeDates() // change dates inside results
    </script>
  </body>
</html>