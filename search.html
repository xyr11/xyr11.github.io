<!DOCTYPE html>
<html lang="en" data-loc="root">
  <head>
    <meta charset="UTF-8">
    <title>Search XYR.codes</title>
    <meta name="author" content="Xyrus Kurt Roldan">
    <meta name="description" content="Search within pages with the all-new special in-house-developed bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm®™, only available in this page.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Search">
    <meta property="og:description" content="Search within pages with the all-new special in-house-developed bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm 99®™, only available in this page.">
    <meta property="og:image" content="http://xyr.codes/i/emb.png">
    <meta property="og:url" content="https://xyr.codes/search.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="theme-color" content="#77e4ff">
    <link href="favicon.ico" rel="shortcut icon" type="image/ico">
    <link href="main.css" rel="stylesheet">
    <style>
      .search {
        margin: .6em 0;
      }
      .searchbar {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: flex-start;
        position: relative;
        overflow: hidden;
      }
      #query {
        padding: .4em 1.8em .4em .4em;
        font-size: inherit;
        flex-grow: 1;
        flex-shrink: 1;
        outline: none;
        border: 1px solid transparent;
        border-radius: 8px;
        max-width: 100%;
        height: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      #query:focus {border-color: var(--link-active)}
      #searchBtn {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        right: .2em;
        font-size: inherit;
        height: 100%;
        cursor: pointer;
        background: transparent;
        border: 1px solid transparent;
        outline: 0;
        transition: color .3s;
      }
      #searchBtn::before {
        font-family: 'simple-line-icons';
        content: '\e090';
        position: relative;
        top: -.05em;
      }
      #searchBtn:hover, #searchBtn:focus {color: var(--footer-bg)}
      #searchBtn:focus-visible {border: 1px solid}
      @media (min-width: 450px) {
        .focus #query {padding-right: 5.5em}
        #searchBtn {
          animation: fancyReverse .6s;
        }
        #searchBtn::after {
          visibility: hidden;
          opacity: 0;
          content: '';
          font-family: inherit;
          padding-left: .3em;
          animation: fadeReverse .6s;
        }
        .focus #searchBtn, #searchBtn:hover {
          right: .3em;
          animation: fancy .6s;
        }
        .focus #searchBtn::after, #searchBtn:hover::after {
          visibility: visible;
          opacity: 1;
          content: 'Search';
          animation: fade .6s;
        }
      }

      #advanced .fieldsets {
        display: flex;
        flex-wrap: wrap;
      }
      #advanced summary {
        margin-bottom: .5em;
      }
      .fieldsets fieldset {
        width: calc(50% - 1em);
        min-width: 120px;
        flex-grow: 1;
        margin: 0 .5em .5em .5em;
        border: 1px solid var(--link-active);
      }
      .fieldsets fieldset input {
        height: 1em;
        width: 1em;
        font-size: 1em;
      }

      @keyframes fancy {
        0% {right: -3.1em}
        100% {right: .3em}
      }
      @keyframes fancyReverse {
        0% {right: .3em}
        30% {right: .3em}
        31% {right: 3.1em}
        100% {right: .3em}
      }
      @keyframes fade {
        0% {visibility: hidden; opacity: 0}
        45% {visibility: hidden; opacity: 0}
        100% {visibility: visible; opacity: 1}
      }
      @keyframes fadeReverse {
        0% {visibility: visible; opacity: 1; content: 'Search'}
        55% {visibility: hidden; opacity: 0}
        100% {visibility: hidden; opacity: 0}
      }
    </style>
  </head>
  <body>
    <header role="banner">
      <div id="bg" style="background-color:#0B161D" aria-hidden="true"></div>
      <h1 aria-labelledby="pagetitle"><a id="pagetitle" href="index.html">XYR<span style="color:#77e4ff">.</span>codes</a></h1>
      <p aria-label="Subtitle">Projects, tutorials, photography, blogs, and more!</p>
    </header>
    <nav role="navigation">
      <a href="index.html">Home</a>
      <a href="search.html?t=Programming" aria-label="Browse pages under Programming">Programming</a>
      <a href="search.html?t=Journals" aria-label="Browse pages under Journals">Journals</a>
      <a href="search.html?t=Photography" aria-label="Browse pages under Photography">Photography</a>
      <a href="site/about.html">About</a>
      <a id="search" class="icon" href="search.html" aria-label="Search XYR.codes">Search</a>
    </nav>
    <div class="main">
      <main role="main" aria-labelledby="title">
        <h1 id="title" class="posts">Search</h1>
        <div id="msg"></div>
        <div class="search">
          <div class="searchbar">
            <input type="text" id="query" placeholder="Enter words..." aria-label="Search XYR.codes"> <button id="searchBtn" aria-label="Click to search" tabindex="0"></button>
          </div>
          <div id="categoryHeader" style="margin: 1em 0 .6em 0"></div>
          <details id="advanced">
            <summary>Advanced options</summary>
            <div class="fieldsets">
              <fieldset id="includes">
                <legend>Search includes:</legend>
                <div> <input type="checkbox" id="name"> <label for="name" title="article/page title">Name</label> </div>
                <div> <input type="checkbox" id="desc"> <label for="desc" title="meta description">Page description</label> </div>
                <div> <input type="checkbox" id="content"> <label for="content">Page content</label> </div>
                <div> <input type="checkbox" id="date"> <label for="date">Date posted/updated</label> </div>
                <div> <input type="checkbox" id="alt"> <label for="alt" title="alt text of images">Image descriptions</label> </div>
              </fieldset>
              <fieldset>
                <legend>Sort results by:</legend>
                <div> <input type="radio" id="relevance" name="sort"> <label for="relevance" title="Sorted with the highest 'word and potential word' count">Relevance</label> </div>
                <div> <input type="radio" id="relevanceplus" name="sort"> <label for="relevanceplus" title="'Word and potential word' count but taking into account the total number of words">Relevance+</label> </div>
                <div> <input type="radio" id="date-new" name="sort"> <label for="date-new">Date (newest)</label> </div>
                <div> <input type="radio" id="date-old" name="sort"> <label for="date-old">Date (oldest)</label> </div>
                <div> <input type="radio" id="alphabetical" name="sort"> <label for="alphabetical">Alphabetical</label> </div>
              </fieldset>
            </div>
          </details>
        </div>
        <div id="output" class="horiz" aria-label="Search results"></div>
      </main>
      <aside></aside>
    </div>
    <footer role="contentinfo" aria-label="Footer">
      <h1 class="name">XYR.codes</h1>
      <p>Powered by the special in-house-developed very powerful bunch-of-overly-enthusiastic-words XYR.codes Finder Algorithm 99®™, only available in this page.</p>
      <div class="ico" aria-hidden="true">
        <img src="i/fav.ico" alt="">
      </div>
      <div class="links" aria-label="Footer links">
        <div class="col">
          <a href="index.html">Home</a>
          <a href="site/about.html">About</a>
          <a href="contact/index.html">Contact</a>
          <a href="contact/feedback.html">Feedback</a>
        </div>
        <div class="col">
          <a href="search.html">Search</a>
          <a href="versions/index.html">Versions</a>
          <a href="site/credits.html">Credits</a>
          <a href="site/sitemap.html">Sitemap</a>
        </div>
        <div class="col">
          <span class="social">
            <a class="gthb" href="https://github.com/xyr11/xyr11.github.io" title="Check the repository on GitHub"></a> <a class="twtr" href="https://twitter.com/xy_rus/" title="Follow me on Twitter"></a> <a class="doc" href="https://github.com/xyr11/xyr11.github.io/blob/main/README.md" title="Read the README.md file"></a>
          </span>
          <a href="site/license.html">License</a>
          <a id="gototop" tabindex="0">Go to top</a>
        </div>
      </div>
    </footer>
    <!-- <script type="text/javascript" src="https://xyr11.github.io/files/version.js"></script> --> <!-- Check version online thru this link -->
    <script src="files/search.js"></script>
    <script type="text/javascript" src="files/main.js"></script>
    <!-- Magic happens here -->
    <script>
      // Search
      // search bar
      const searchBar = document.querySelector('.searchbar').classList
      const searchBtn = id('searchBtn')
      const query = id('query')

      // for aesthetics only
      query.addEventListener('focus', () => searchBar.add('focus'))
      query.addEventListener('blur', () => searchBar.remove('focus'))

      // if clicked searchBtn
      searchBtn.addEventListener('click', () => {if (query.value) window.location.href = `search.html?q=${query.value}`
      })
      // if pressed enter
      query.addEventListener('keydown', e => (e.key === 'Enter') && searchBtn.click())
      searchBtn.addEventListener('keydown', e => (e.key === 'Enter') && searchBtn.click())

      // advanced options
      // includes
      const includesValues = ['name', 'desc', 'content', 'date', 'alt']
      // sort
      const sortValues = ['relevance', 'relevanceplus', 'date-new', 'date-old', 'alphabetical']

      // check search params
      function searchParam (param = new URLSearchParams(new URL(document.URL).search)) {
        // check query and type
        // only one of them can be searched separately. query will take precendence over type if they are both used together
        let query = param.get('q') || param.get('query')
        let type = param.get('t') || param.get('type')
        // if there aren't any values on either, return null
        if (!query && !type) return { type: null }
        // set input display to whatever param given
        if (query) id('query').value = query
        // if type, hide the 'search includes' advanced options
        if (!query) id('includes').style.display = 'none'

        // get includes
        // note that 'includes' only affects query search and not type search
        let includes = param.get('i') || param.get('includes') || 'name,desc,content,date,alt'
        // filter includes
        if (includes) {
          includes = includes.split(',')
          for (const i of includes) {
            // if not a valid value, remove that value
            if (includesValues.indexOf(i) <= -1) includes.splice(includes.indexOf(i), 1)
            // else set the checkbox to true
            else id(i).checked = true
          }
        }

        // get sort
        let sort = param.get('s') || param.get('sort') || 'relevance'
        if (sortValues.indexOf(sort) <= -1) sort = 'relevance'
        id(sort).checked = true // display

        return {
          type: query ? 'query' : type ? 'type' : null,
          search: query ? query : type,
          includes: query ? includes.join(' ') : null,
          sort
        }
      }

      let result = searchParam()
      let rawOutput
      if (result.type === 'query') {
        // if query
        rawOutput = Search.text(result.search, result.includes, result.sort)
      } else if (result.type === 'type') {
        // if type
        id('title').style.display = 'none'
        id('categoryHeader').innerHTML = `<h1>Category: ${result.search}</h1>`
        rawOutput = Search.type(result.search, result.sort)
      } else {
        // search home
        id('msg').innerHTML = 'Search for stuff within XYR.codes by entering it in the search bar below and we\'ll give back pages with that stuff. Word order is not checked.'
      }

      // advanced options
      const advanced = tag('.fieldsets')

      // sort
      // add event listener
      advanced.addEventListener('input', () => {
        console.log('test')
      })

      // display results
      const output = id('output')
      if (rawOutput) {
        if (!rawOutput.length) output.innerHTML = 'Unfortunately, we didn\'t find any results. Please try again.'
        for (const i of rawOutput) {
          // create element
          const result = document.createElement('a')
          result.setAttribute('href', i.location)
          result.setAttribute('class', 'post result')
          result.innerHTML = `<h2>${i.name}</h2>${i.date ? `<p class="time" data-posted="${new Date(i.date).toISOString().slice(0,10)}">${new Date(i.date).toLocaleString('default', {dateStyle: 'long'})}</p>` : ''}<p>${i.desc}</p>`
          output.appendChild(result)
        }
      }
      changeDates()
    </script>
  </body>
</html>